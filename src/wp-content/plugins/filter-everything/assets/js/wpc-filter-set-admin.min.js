function insertAtCaret(e,t,i){let l=e.val(),a=l.substring(0,i)+t+l.substring(i);return a=a.replace(/ +(?= )/g,""),e.val(a),!0}function uniqId(e,t){void 0===e&&(e="");var i,l=function(e,t){return t<(e=parseInt(e,10).toString(16)).length?e.slice(e.length-t):t>e.length?Array(1+(t-e.length)).join("0")+e:e},a="undefined"!=typeof window?window:global;a.$locutus=a.$locutus||{};var n=a.$locutus;return n.php=n.php||{},n.php.uniqidSeed||(n.php.uniqidSeed=Math.floor(123456789*Math.random())),n.php.uniqidSeed++,i=e,i+=l(parseInt(new Date().getTime()/1e3,10),8),i+=l(n.php.uniqidSeed,5),t&&(i+=(10*Math.random()).toFixed(8).toString()),i}!function(e){"use strict";let t=!1,i=wpcSetVars.postTypesTaxList,l=wpcSetVars.numFieldNoTaxes,a=wpcSetVars.numFieldAttrs;function n(e){e.fadeTo(100,0,function(){e.slideUp(100,function(){e.remove()})})}function s(t,i){let l=e("#"+t);void 0!==l&&l.before('<div class="wpc-field-notice wpc-field-notice-error"><p>'+i+"</p></div>")}function o(e){let t=e.find(".wpc-filter-head"),i=t.next(".wpc-filter-body");t.addClass("wpc-opened"),i.slideDown({duration:200,complete:function(){i.addClass("wpc-opened")}})}function p(t){t.find(".wpc-filter-additional-fields").slideUp({duration:200,complete:function(){e(this).removeClass("wpc-opened")}})}function d(t,i){var l,a;let n="",s,o,p,d=(l=e("."+t.attr("class")),a=t,s=[],o="",p=["post_meta","post_meta_num","post_meta_exists","tax_numeric"],l.length>0&&(l.each(function(){o=e(this).val(),!(e(this).attr("id")==a.attr("id")||p.includes(o))&&o&&s.push(o)}),s)),c=function t(){if(void 0!==wpcSetVars.postTypesTaxList){let i=e("#wpc_set_fields-post_type").val(),l=[],a=[];return void 0!==wpcSetVars.postTypesTaxList[i]&&e.each(wpcSetVars.postTypesTaxList[i],function(e,t){l.push(t.name)}),e.each(wpcSetVars.postTypesTaxList,function(t,n){t!==i&&e.each(n,function(e,t){!1===l.includes(t.name)&&a.push(t.name)})}),a}return[]}();return t.find("option").each(function(){("post_meta_exists"!==(n=e(this).val())||!(wpcSetVars.filtersPro<1))&&("tax_numeric"!==n||!(wpcSetVars.filtersPro<1))&&(d.includes(n)||c.includes(n)?e(this).attr("disabled","disabled"):e(this).removeAttr("disabled"))}),"disabled"!==t.find("option:selected").attr("disabled")||i||t.find("option:not([disabled]):first").prop("selected",!0).trigger("change"),!0}function c(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");i=f(i);let a=e("#wpc-filter-id-"+l+" .wpc-form-fields-table");wpcSetVars.swatchesTaxonomies.includes(i)?a.addClass("taxonomy-has-swatches"):a.removeClass("taxonomy-has-swatches"),wpcSetVars.brandEntities.includes(i)?a.addClass("wpc-filter-has-brands"):a.removeClass("wpc-filter-has-brands"),wpcSetVars.ratingTaxonomies.includes(i)?a.addClass("selected-and-above-show"):a.removeClass("selected-and-above-show")}function r(t){let i=0;e(".wpc-new-filter-item .wpc-field-entity").each(function(){let t=e(this),l=!1;e(this).attr("id")==t.attr("id")&&(l=!0),setTimeout(function(){d(t,l)},i),i+=100})}function f(e){let t=e;return e.includes("taxonomy_")?"taxonomy_"===e.slice(0,9)&&(t=e.slice(9)):e.includes("author_")&&"author_"===e.slice(0,7)&&(t=e.slice(7)),t}function w(t){if(wpcSetVars.filtersPro<1||""===t)return!0;n(e(".wpc-field-notice"));let i=e(".wpc_set_fields-wp_filter_query-wrap").children(".spinner"),l=e("#wpc_set_fields-post_type").val(),a={};a._wpnonce=e("#wpc_set_nonce").val(),a.wpPageType=e("#wpc_set_fields-wp_page_type").val(),a.postType=l,a.postId=e("#post_ID").val(),a.action="wpc_get_wp_queries",e.ajax({method:"POST",data:a,url:t,dataType:"html",beforeSend:function(){i.addClass("is-active"),e(".wpc-location-preview").attr("href",t)},complete:function(){i.removeClass("is-active")},success:function(t){let i=e(t).find("#wpc_set_fields-wp_filter_query"),l=e(t).find("#wpc_query_vars");""!==i&&i.length>0&&e("#"+wpcSetVars.wPQuerySelectId).replaceWith(i),l.length>0&&e("#wpc_query_vars").replaceWith(l)},error:function(e){}})}function u(t){let i=e(".wpc_set_fields-post_name-wrap").children(".spinner");i.addClass("is-active"),n(e(".wpc-field-notice"));let l=e("#wpc_set_fields-post_type").val(),a={};a._wpnonce=e("#wpc_set_nonce").val(),a.wpPageType=t,a.postType=l,a.postId=e("#post_ID").val(),wp.ajax.post("wpc-get-set-location-terms",a).always(function(){i.removeClass("is-active")}).done(function(t){let i=e(t.html).find("#wpc_set_fields-post_name");e("#wpc_set_fields-post_name").replaceWith(i);let l=e("option:selected",e("#wpc_set_fields-post_name")).data("link");void 0!==l&&w(l)}).fail(function(e){void 0!==e&&s("wpc_set_fields-post_name",e.message)})}function m(e,t){let i;i=e.val(),t.text(i)}function h(){e(".wpc-filter-item").each(function(t,i){var l=t+1;e(i).find(".wpc-menu-order-field").attr("value",l),e(i).find(".wpc-filter-order").attr("title",l)})}function v(){e(".wpc-filter-item:not(.wpc-filter-not-listed)").length>0?e(".wpc-no-filters").hide():!1===e(".wpc-filter-not-listed").hasClass("wpc-opened")&&e(".wpc-no-filters").show()}function b(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid"),a="";i.startsWith("taxonomy_pa_")&&(a=" taxonomy-product-attribute"),-1!==i.indexOf("taxonomy")&&(i="taxonomy"),e("#wpc-filter-id-"+l+" .wpc-form-fields-table").attr("class","wpc-form-fields-table wpc-filter-"+i+a)}function y(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");if(void 0!==wpcSetVars.filterSlugs[i]){let a=wpcSetVars.filterSlugs[i];e("#wpc_filter_fields-"+l+"-slug").val(a).attr("readonly","readonly").trigger("input")}else e("#wpc_filter_fields-"+l+"-slug").val("").removeAttr("readonly").trigger("input")}function g(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");i.includes("taxonomy_pa")?(e("#wpc_filter_fields-"+l+'-orderby option[value="menuasc"]').removeAttr("disabled"),e("#wpc_filter_fields-"+l+'-orderby option[value="menudesc"]').removeAttr("disabled")):(e("#wpc_filter_fields-"+l+'-orderby option[value="menuasc"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-orderby option[value="menudesc"]').attr("disabled","disabled"))}function x(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");"post_meta_num"===i||"tax_numeric"===i?(e("#wpc_filter_fields-"+l+'-view option:not([value="range"])').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-view option[value="range"]').removeAttr("disabled").prop("selected",!0),e("#wpc_filter_fields-"+l+"-view").trigger("change")):"taxonomy_product_visibility"===i?(e("#wpc_filter_fields-"+l+'-view option[value="rating"]').removeAttr("disabled").prop("selected",!0),e(".wpc-form-fields-table").addClass("wpc-view-rating")):"post_date"===i?(e("#wpc_filter_fields-"+l+'-view option:not([value="date"])').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-view option[value="date"]').removeAttr("disabled").prop("selected",!0),e("#wpc_filter_fields-"+l+"-view").trigger("change")):(e("#wpc_filter_fields-"+l+"-view option").removeAttr("disabled"),e("#wpc_filter_fields-"+l+"-view option:not([disabled]):first").prop("selected",!0),e("#wpc_filter_fields-"+l+'-view option[value="range"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-view option[value="rating"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-view option[value="date"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+"-view").trigger("change"))}function $(t){let i=t.val(),l=t.parents(".wpc-filter-item");-1!==i.indexOf("taxonomy")?e.each(wpcSetVars.postTypesTaxList,function(t,a){e.each(a,function(e,t){t.name===i&&(t.hierarchical?l.find(".wpc-form-fields-table").addClass("taxonomy-hierarchical"):l.find(".wpc-form-fields-table").removeClass("taxonomy-hierarchical"))})}):l.find(".wpc-form-fields-table").removeClass("taxonomy-hierarchical")}function C(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");if("post_meta"===i||"post_meta_num"===i||"post_meta_exists"===i){let n=e("#wpc_filter_fields-"+l+"-e_name");if("select"===n.prop("tagName").toLowerCase()){let s=e("<input>");e("#wpc_set_fields-post_type").val(),s.attr("class",n.attr("class")).attr("type","text").attr("name",n.attr("name")).attr("id",n.attr("id")),n.val(""),n.removeAttr("readonly"),n.replaceWith(s),s.parents(".wpc-field-ename-tr").show()}else n.val(""),n.parents(".wpc-field-ename-tr").show();e("#wpc-filter-id-"+l+" .wpc-field-ename-tr p.wpc-field-description").text(a.post_meta_num.description),e("#wpc-filter-id-"+l+" .wpc-field-ename-tr label.wpc-filter-label span.wpc-label-text").text(a.post_meta_num.label),e("#wpc-filter-id-"+l+" .wpc-field-ename-tr p.description").css("visibility","visible")}else if("tax_numeric"===i){let o=e("#wpc_filter_fields-"+l+"-e_name"),p=e("#wpc_set_fields-post_type").val();if("input"===o.prop("tagName").toLowerCase()){let d=e("<select>");d.attr("class",o.attr("class")).attr("name",o.attr("name")).attr("id",o.attr("id")),o.removeAttr("readonly"),o.replaceWith(d),S(d,p),d.parents(".wpc-field-ename-tr").show()}else S(o,p),o.parents(".wpc-field-ename-tr").show();e("#wpc-filter-id-"+l+" .wpc-field-ename-tr p.wpc-field-description").text(a.tax_numeric.description),e("#wpc-filter-id-"+l+" .wpc-field-ename-tr label.wpc-filter-label span.wpc-label-text").text(a.tax_numeric.label),e("#wpc-filter-id-"+l+" .wpc-field-ename-tr p.description").css("visibility","hidden")}else e("#wpc_filter_fields-"+l+"-e_name").parents(".wpc-field-ename-tr").hide();"post_meta_num"===i||"tax_numeric"===i||"post_date"===i?e("#wpc_filter_fields-"+l+"-in_path").prop("checked",!1):e("#wpc_filter_fields-"+l+"-in_path").prop("checked",!0)}function _(t,i,l){n(e(".wpc-field-notice"));let a={},s=e("#wpc_filter_fields-"+i+"-exclude");a._wpnonce=e("#wpc_set_nonce").val(),a.fid=i,a.entity=t,void 0!==l&&(a.ename=l);let o=s.parent(".wpc-after-spinner-container").prev(".spinner");o.addClass("is-active"),wp.ajax.post("wpc-load-exclude-terms",a).always(function(){o.removeClass("is-active")}).done(function(e){void 0!==e.fid&&(s.select2("destroy"),s.html(""),s.select2({width:"100%",placeholder:wpcSetVars.excludePlaceholder,data:e.terms,disabled:!1}))}).fail(function(e){})}function k(e,t,i){var l=(t=t.replace("[]","[%%index%%]")).match(/([^\[\]])+/g);if(l)for(var a=l.length,n=e,s=0;s<a;s++){var o=String(l[s]);s==a-1?"%%index%%"===o?n.push(i):n[o]=i:("%%index%%"===l[s+1]?T(n[o])||(n[o]=[]):A(n[o])||(n[o]={}),n=n[o])}}function T(e){return Array.isArray(e)}function A(e){return"object"==typeof e}function S(t,a){t.find("option").remove().end(),a in i?e(i[a]).each(function(){t.append(e("<option>").attr("value",this.name).text(this.label))}):t.append(e("<option>").attr("value",-1).text(l))}e.fn.getCursorPosition=function(){var e=this.get(0);if(e){if("selectionStart"in e)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange(),i=document.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-i}}},e(document).ready(function(){e("form#post").on("submit",function(i){var l,a;n(e(".wpc-field-notice")),n(e("#message"));let p,d;if(d=(p=(l=e(".wpc-filter-item")).find(".wpc-filter-head")).next(".wpc-filter-body"),p.removeClass("wpc-opened"),d.slideUp({duration:200,complete:function(){d.removeClass("wpc-opened")}}),!t){i.preventDefault();let c,r;a=e(this),c=e("#publishing-action .spinner"),r={},c.addClass("is-active"),r.validateData=function e(t){for(var i={},l=t.find("select, textarea, input").serializeArray(),a=0;a<l.length;a++)k(i,l[a].name,l[a].value);return i}(a),wp.ajax.post("wpc-validate-filters",r).always(function(){c.removeClass("is-active")}).done(function(e){t=!0,a.submit()}).fail(function(t){var i;let l=[],a="",n,p,d;void 0!==t.errors&&(e.each(t.errors,function(t,i){void 0!==i.id?(s(i.id,i.message),a=e("#"+i.id).parents(".wpc-filter-item"),o(a),e("#"+i.id).parents(".wpc-filter-additional-fields").length>0&&function t(i){i.find(".wpc-filter-additional-fields").slideDown({duration:200,complete:function(){e(this).addClass("wpc-opened")}})}(a)):l.push(i.message)}),l.length<1&&l.push("Error: Set was not saved."),i=l,n=e("form#post"),p="",e.each(i,function(e,t){p+="<p>"+t+"</p>"}),d='<div id="message" class="error notice notice-error is-dismissible">'+p+'<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button></div>',void 0!==n&&(e("#message").length>0&&e("#message").remove(),n.before(d)))})}}),e(".wpc-add-filter").on("click",function(t){t.preventDefault();let i=e("#wpc-new-filter").html(),l=e(i),a="wpc_new_id",n=uniqId("filter_"),s=function(e,t){return t.replace(a,n)},p=e("#wpc-filters-list");l.find('[id*="'+a+'"]').attr("id",s),l.find('[for*="'+a+'"]').attr("for",s),l.find('[name*="'+a+'"]').attr("name",s),l.find('[class*="'+a+'"]').attr("class",s),l.data("fid",n),l.attr("id","wpc-filter-id-"+n);let r=e(".wpc-filter-item").last();if(r.hasClass("wpc-filter-not-listed")){let w=r.prev(".wpc-filter-item");w.hasClass("wpc-filter-not-listed")?w.before(l):r.before(l)}else p.append(l);let u=l.find(".wpc-field-entity"),m,_,k,T,A,S,P;y(u),C(u),b(u),x(u),g(u),d(u),$(u),c(u),l.find(".wpc-field-exclude").select2({width:"100%",placeholder:wpcSetVars.excludePlaceholder}),1===e(".wpc-filter-item:not(.wpc-filter-not-listed)").length&&u.trigger("change"),e(".wpc-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200,keepAlive:!0,maxWidth:"220px"}),o(l),h(),v(),m={},_=0,k="",T="",A=!1,S=!1,P=!1,e(".wpc-filter-item:not(.wpc-filter-not-listed)").each(function(t,i){_=e(this).data("fid"),(k=e("#wpc_filter_fields-"+_+"-label").val())||(k=wpcSetVars.newFilter),T=e("#wpc_filter_fields-"+_+"-entity").val(),m[_]={id:_.toString(),title:k,ename:T}}),!(Object.keys(m).length<2)&&e.each(m,function(t,i){(A=e("#wpc_filter_fields-"+i.id+"-parent_filter > option[value='no']")).length>0&&(A.val("-1"),A.text(wpcSetVars.selectFilter)),e.each(m,function(t,l){i.id!==t&&(S=e("#wpc_filter_fields-"+i.id+"-parent_filter > option[value='"+t+"']")).length<1&&(P=e("<option>",{value:t,text:l.title+" ("+f(l.ename)+")"}),("post_meta_num"===l.ename||"tax_numeric"===l.ename)&&P.attr("disabled","disabled"),e("#wpc_filter_fields-"+i.id+"-parent_filter").append(P))})})}),e(".wpc-form-fields-table:not(.wpc-filter-tax_numeric) .wpc-field-exclude, .wpc-form-fields-table:not(.wpc-filter-post_meta_num) .wpc-field-exclude, .wpc-form-fields-table:not(.wpc-filter-post_meta_exists) .wpc-field-exclude").select2({width:"100%",placeholder:wpcSetVars.excludePlaceholder}),e("body").on("click",".notice-dismiss",function(t){t.preventDefault(),n(e("#message"))}),e("body").on("click",".wpc-button-link-delete",function(t){t.preventDefault(),e(this).parents(".wpc-filter-label-td").next(".wpc-filter-field-td").children(".wpc-filter-delete-wrapper").css("visibility","visible")}),e("body").on("click",".wpc-filter-delete-cancel",function(t){t.preventDefault(),n(e(".wpc-field-notice")),e(this).parents(".wpc-filter-delete-wrapper").css("visibility","hidden")}),e("body").on("click",".wpc-done-action",function(t){e(this).parents(".wpc-filter-body").slideToggle(200).toggleClass("wpc-opened").children(".wpc-filter-additional-fields").removeClass("wpc-additional-opened").hide(),e(this).parents(".wpc-filter-body").prev(".wpc-filter-head").toggleClass("wpc-opened"),e(this).parents(".wpc-filter-field-td").next(".wpc-filter-field-td").find(".wpc-filter-delete-wrapper").css("visibility","hidden")}),e("body").on("click",".wpc-advice-head",function(t){e(this).toggleClass("wpc-opened")}),e("body").on("click",".wpc-title-action",function(t){let i=e(this).parent(".wpc-filter-head"),l=i.next(".wpc-filter-body");i.toggleClass("wpc-opened"),l.slideToggle(200).toggleClass("wpc-opened").children(".wpc-filter-additional-fields").removeClass("wpc-additional-opened").hide(),l.find(".wpc-filter-delete-wrapper").css("visibility","hidden");let a=l.find(".wpc-more-options-toggle");a.hasClass("wpc-opened")&&a.trigger("click")}),e("body").on("click",".wpc-more-options-toggle",function(t){t.preventDefault();e(this).text()===wpcSetVars.moreOptions?e(this).text(wpcSetVars.lessOptions):e(this).text(wpcSetVars.moreOptions),e(this).toggleClass("wpc-opened"),e(this).parents(".wpc-filter-body").find(".wpc-filter-additional-fields").slideToggle(200).toggleClass("wpc-additional-opened")}),e("body").on("change","select.wpc-field-ename",function(t){let i=0;e(e(".wpc-new-filter-item select.wpc-field-ename").get().reverse()).each(function(){let t=e(this);setTimeout(function(){d(t,!1)},i),i+=100})}),e("body").on("change",".wpc-field-entity",function(t){var i;let l=e(this),a="",n,s;r(l),y(l),C(l),n=(i=l).val(),s=i.parents(".wpc-filter-item").data("fid"),"author_author"===n||"post_meta_exists"===n||"taxonomy_product_visibility"===n?(e("#wpc_filter_fields-"+s+'-logic option[value="and"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+s+'-logic option[value="or"]').prop("selected",!0)):"post_meta_num"===n||"tax_numeric"===n||"post_date"===n?(e("#wpc_filter_fields-"+s+'-logic option[value="or"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+s+'-logic option[value="and"]').prop("selected",!0)):(e("#wpc_filter_fields-"+s+'-logic option[value="and"]').removeAttr("disabled"),e("#wpc_filter_fields-"+s+'-logic option[value="or"]').removeAttr("disabled")),b(l),x(l),g(l),$(l),c(l);let o=e(this).val(),p=e(this).parents(".wpc-filter-item").data("fid");("tax_numeric"===o&&e("#wpc_filter_fields-"+p+"-e_name").trigger("change"),["tax_numeric","post_meta","post_meta_num","post_meta_exists","post_date"].includes(o))?e("#wpc_filter_fields-"+p+"-exclude").select2({disabled:!0,width:"100%"}):_(o,p);let d=e(this).find("option:selected").text();e(this).parents(".wpc-filter-item").find(".wpc-filter-head li.wpc-filter-entity").text(d),(a=e("#wpc_filter_fields-"+p+"-label").val())||(a=wpcSetVars.newFilter),e(".wpc-field-parent-filter option[value='"+p+"'").each(function(t,i){e(this).text(a+" ("+f(o)+")"),"post_meta_num"===o||"tax_numeric"===o||"taxonomy_product_visibility"===o?e(this).attr("disabled","disabled"):e(this).removeAttr("disabled")})}),e("body").on("input change",".wpc-field-ename",function(){let t=e(this).val(),i=e(this).parents(".wpc-filter-item").data("fid"),l=e("#wpc_filter_fields-"+i+"-entity").val(),a="",n=wpcSetVars.filterSlugs;void 0!==n[a="post_meta_num"===l?"post_meta_num_"+t:"tax_numeric"===l?"tax_numeric_"+t:"post_meta_exists"===l?"post_meta_exists_"+t:"post_meta_"+t]?(e("#wpc_filter_fields-"+i+"-slug").val(n[a]).trigger("input"),"post_meta_num"!==l&&"tax_numeric"!==l&&_(l,i,t)):(e("#wpc_filter_fields-"+i+"-slug").val("").trigger("input"),e("#wpc_filter_fields-"+i+"-exclude").select2({disabled:!0,width:"100%"}))}),e("body").on("input",".wpc-field-value-step",function(){e(this).val(e(this).val().replace(/,/g,".")),e(this).val(e(this).val().replace(/[^\d\.]/g,""))}),e("body").on("input keydown","#wpc_set_fields-apply_button_text",function(){let t=e("#wpc-filter-id-apply-button").find(".wpc-button-apply");m(e(this),t)}),e("body").on("input keydown","#wpc_set_fields-reset_button_text",function(){let t=e("#wpc-filter-id-apply-button").find(".wpc-button-reset");m(e(this),t)}),e("body").on("input keydown","#wpc_set_fields-search_field_placeholder",function(){e("#wpc-filter-id-search-field").find(".wpc-text-input-search").attr("placeholder",e(this).val())}),e("body").on("input keydown","#wpc_set_fields-search_field_label",function(){let t=e("#wpc-filter-id-search-field").find(".wpc-filter-label");m(e(this),t)}),e("body").on("input keydown",".wpc-field-slug",function(){let t=e(this).parents(".wpc-filter-item").find(".wpc-filter-head li.wpc-filter-slug");m(e(this),t)}),e("body").on("input keydown",".wpc-field-label",function(){let t=e(this).parents(".wpc-filter-item").find(".wpc-filter-head li.wpc-filter-label");m(e(this),t);let i=e(this).parents(".wpc-filter-item").data("fid"),l=e("#wpc_filter_fields-"+i+"-entity").val();l=f(l);let a=e(this).val();e(".wpc-field-parent-filter option[value='"+i+"'").each(function(t,i){e(this).text(a+" ("+l+")")})}),e("body").on("change",".wpc-field-view",function(){let t=e(this).find("option:selected").text(),i=e(this).find("option:selected").val(),l=e(this).parents(".wpc-filter-item"),a;l.find(".wpc-filter-head li.wpc-filter-view").text(t),["checkboxes","radio","labels"].includes(i)?(l.find(".wpc-field-search-tr").show(),l.find(".wpc-field-more-less-tr").show()):(l.find(".wpc-field-search-tr").hide(),l.find(".wpc-field-more-less-tr").hide());let n=l.find(".wpc-form-fields-table");n.removeClass("selected-and-above-show"),"checkboxes"===i?(n.addClass("wpc-view-checkboxes"),n.removeClass("wpc-view-dropdown"),n.removeClass("wpc-view-rating")):"rating"===i?(n.addClass("selected-and-above-show"),n.addClass("wpc-view-rating"),n.removeClass("wpc-view-checkboxes"),n.removeClass("wpc-view-dropdown")):"dropdown"===i?(n.addClass("wpc-view-dropdown"),n.removeClass("wpc-view-checkboxes"),n.removeClass("wpc-view-rating")):(n.removeClass("wpc-view-checkboxes"),n.removeClass("wpc-view-dropdown"),n.removeClass("wpc-view-rating"),n.removeClass("selected-and-above-show"))}),e(".wpc-filter-set-wrapper .wpc-filters-list").sortable({items:"> div.wpc-filter-item",delay:150,placeholder:"wpc-filter-item-shadow",refreshPositions:!0,cursor:"move",handle:".wpc-filter-order",axis:"y",update:function(e,t){h()},start:function(t,i){let l=i.item.children(".wpc-filter-head"),a=i.item.children(".wpc-filter-body");a.hasClass("wpc-opened")&&(a.removeClass("wpc-opened").hide(),l.removeClass("wpc-opened"),e(this).sortable("refreshPositions")),e(".wpc-filter-item-shadow").css("min-height",l.height()+"px")}}),e(".wpc-filter-set-wrapper .wpc-filters-list").keydown(function(e){65==e.keyCode&&(e.ctrlKey||e.metaKey)&&e.target.select()}),e(".wpc-filters-list").disableSelection(),e("body").on("click",".wpc-filter-delete",function(){n(e(".wpc-field-notice"));let t=e(this).prev(".spinner");t.addClass("is-active");let i={};i._wpnonce=e("#wpc_set_nonce").val(),i.fid=e(this).data("fid"),"wpc_new_id"===i.fid&&e(this).parents(".wpc-filter-item").slideUp({duration:200,complete:function(){e(this).remove(),h(),v()}});let l;(function t(i){let l=!1;e(".wpc-field-parent-filter option[value='"+i+"'").each(function(t,i){let a=(l=e(this)).parents("select");l.is(":selected")&&a.val(a.find("option:first").val()),l.remove(),1===a.find("option").length&&((l=a.find("option:first")).val("no"),l.text(wpcSetVars.addFilter),a.val("no"))})})(e(this).parents(".wpc-filter-item").data("fid")),wp.ajax.post("wpc-delete-filter",i).always(function(){t.removeClass("is-active")}).done(function(t){void 0!==t&&void 0!==t.fid&&e("#wpc-filter-id-"+t.fid).slideUp({duration:200,complete:function(){e(this).remove(),h(),v(),r()}})}).fail(function(e){void 0!==e&&s("wpc-filter-delete-wrapper-"+e.fid,e.message)})});""!=e("#wpc_set_fields-post_type option:selected").data("link")&&e(".wpc-location-preview-not-pro").removeClass("display-none"),e("body").on("change","#wpc_set_fields-post_type",function(){let t=e(this).val();e("#wpc-filters-list").attr("data-posttype",t);let i=e("option:selected",this).data("link");if(e(".wpc-location-preview-not-pro").attr("href",i),""!=i?e(".wpc-location-preview-not-pro").removeClass("display-none"):e(".wpc-location-preview-not-pro").addClass("display-none"),wpcSetVars.filtersPro<1)return!0;d(e(".wpc-new-filter-item .wpc-field-entity")),n(e(".wpc-field-notice"));let l=e("#wpc_set_fields-wp_page_type").val();void 0!==l&&u(l);let a=e("select.wpc-field-ename");a.length>0&&S(a,t)}),e("body").on("change","#wpc_set_fields-wp_page_type",function(){u(e(this).val())}),e("body").on("change","#wpc_set_fields-apply_button_page_type",function(){var t;let i,l,a;t=e(this).val(),i=e(".wpc_set_fields-apply_button_post_name-wrap").children(".spinner"),i.addClass("is-active"),n(e(".wpc-field-notice")),l=e("#wpc_set_fields-post_type").val(),a={},a._wpnonce=e("#wpc_set_nonce").val(),a.wpPageType=t,a.postType=l,a.postId=e("#post_ID").val(),a.fieldKey="apply_button_post_name",wp.ajax.post("wpc-get-set-location-terms",a).always(function(){i.removeClass("is-active")}).done(function(t){let i=e(t.html).find("#wpc_set_fields-apply_button_post_name");e("#wpc_set_fields-apply_button_post_name").replaceWith(i)}).fail(function(e){void 0!==e&&s("wpc_set_fields-apply_button_post_name",e.message)})}),e("body").on("change","#wpc_set_fields-post_name",function(t){let i=e("option:selected",this).data("link");void 0!==i&&w(i)}),e("body").on("change",".wpc-date-format",function(t){let i=e(this).attr("name"),l=e('.wpc-date-custom-format[name="'+i+'"]');"other"===e(this).attr("value")?l.removeAttr("disabled"):(l.val(e(this).val()),l.attr("disabled","disabled"))}),e("body").on("change",".wpc-date-type",function(t){let i=e(this).parents(".wpc-filter-item").data("fid"),l=e(".wpc_filter_fields-"+i+"-date_format-wrap").children(".spinner");l.addClass("is-active");let a={};a.setId=e("#post_ID").val(),a.dateType=e("#wpc_filter_fields-"+i+"-date_type").val(),a.fid=i,wp.ajax.post("wpc_get_date_formats",a).always(function(){l.removeClass("is-active")}).done(function(t){if(void 0!==t.html){let l=!0,a=e(t.html).find("ul");e.each(a.find("input.wpc-date-format"),function(t,i){if(e(this).is(":checked")){l=!1;return}}),!0===l&&a.find("input.wpc-date-format:first").attr("checked","checked"),e(".wpc_filter_fields-"+i+"-date_format-wrap ul").replaceWith(a)}}).fail(function(e){})}),e("body").on("change",".wpc-field-parent-filter",function(){let t=e(this).val(),i=e(this).parents(".wpc-filter-item").data("fid"),l=e("#wpc-filter-id-"+i+" .wpc-field-hide-until-parent-tr");["no","-1"].includes(t)?l.removeClass("wpc-opened"):l.addClass("wpc-opened")}),e("body").on("click","#wpc_set_fields-use_apply_button",function(){e(this).prop("checked")?(e("#wpc-filter-id-apply-button").addClass("wpc-opened"),e(".wpc-field-apply-button-text-tr").addClass("wpc-opened"),e(".wpc-field-apply-button-page-type-tr").addClass("wpc-opened"),e(".wpc-field-reset-button-text-tr").addClass("wpc-opened"),e(".wpc-no-filters").hide()):(e("#wpc-filter-id-apply-button").removeClass("wpc-opened"),e(".wpc-field-apply-button-text-tr").removeClass("wpc-opened"),e(".wpc-field-apply-button-page-type-tr").removeClass("wpc-opened"),e(".wpc-field-reset-button-text-tr").removeClass("wpc-opened"),e(".wpc-filter-item:visible").length<1&&e(".wpc-no-filters").show())}),e("body").on("click","#wpc_set_fields-use_search_field",function(){e(this).prop("checked")?(e("#wpc-filter-id-search-field").addClass("wpc-opened"),e(".wpc-search-field-placeholder-tr").addClass("wpc-opened"),e(".wpc-search-field-label-tr").addClass("wpc-opened"),e(".wpc-no-filters").hide()):(e("#wpc-filter-id-search-field").removeClass("wpc-opened"),e(".wpc-search-field-placeholder-tr").removeClass("wpc-opened"),e(".wpc-search-field-label-tr").removeClass("wpc-opened"),e(".wpc-filter-item:visible").length<1&&e(".wpc-no-filters").show())}),e("body").on("focus keypress blur",".wpc-field-min-num-label, .wpc-field-max-num-label",function(t){let i=e(this).getCursorPosition();e(this).data("caret",i)}),e("body").on("click",".wpc-variable-inserter",function(t){let i=e(this).parents(".wpc-filter-field-min-max-labels-wrap");e.each(i.find('input[type="text"]'),function(t,i){let l=e(i),a="{value}",n=l.data("caret");0===n?a+=" ":a=n===l.val().length?" "+a:" "+a+" ",insertAtCaret(l,a,n)})});let i=e("option:selected",e("#wpc_set_fields-post_name")).data("link");e(".wpc-location-preview").addClass("display-none"),void 0!==i&&i&&(e(".wpc-location-preview").removeClass("display-none"),w(i));let l=e("option:selected",e("#wpc_set_fields-post_type")).data("link");void 0!==l&&l&&(e(".wpc-location-preview-not-pro").attr("href",l),e(".wpc-location-preview-not-pro").removeClass("display-none"))})}(jQuery);